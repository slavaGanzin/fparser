steps:
  - db:
      action: skip
      key: processed_pages
      id: $url
  - get:
      url: $url
  - parallel:
      url:
        - input: $url
      links:
        - find: a
        - attr: href
        - uniq
        - replace:
          - /#.*/
          - /\/$/
        # - filter:
        #   - $url
        - tap:
            name: parsers/links.yaml
            placeholders:
              $url: $1
      baseurl:
        - input: $url
        - url: host
      html:
        - html
  - db:
      key: pages
      id:  $url
